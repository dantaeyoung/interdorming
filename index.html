<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blue Cliff Monastery Dorm Assignment Tool</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="window">
        <div class="title-bar">
            <button class="close hidden">
                <span>Close</span>
            </button>
            <h1 class="title">Blue Cliff Monastery Dorm Assignment Tool</h1>
            <button class="resize hidden">
                <span>Resize</span>
            </button>
        </div>
        <div class="separator">
            <ul role="menu-bar">
                <li role="menu-item" id="assignmentTab" class="active">
                    Guest Assignment
                </li>
                <li role="menu-item" id="configurationTab">
                    Room Configuration
                </li>
                <li role="menu-item" id="settingsTab">
                    Settings
                </li>
            </ul>
        </div>

        <!-- Guest Assignment Tab Content -->
        <div id="assignmentContent" class="window-pane tab-content active">
            <div class="details-bar">
                <div class="field-row">
                    <label for="csvFile">Upload CSV File</label>
                    <input type="file" id="csvFile" accept=".csv" />
                </div>
                <div class="field-row">
                    <button class="btn" id="undoBtn" style="display: none;" disabled>Undo</button>
                    <button class="btn" id="exportBtn" style="display: none;">Export CSV</button>
                    <button class="btn" id="resetAssignmentsBtn" style="display: none;">Reset All Assignments</button>
                    <button class="btn" id="deletePeopleBtn" style="display: none;">Delete All People Data</button>
                </div>
            </div>
            <div id="statusMessage" class="status-message"></div>

            <div class="main-container" style="display: flex; gap: 1rem;">
                <div class="standard-dialog" style="flex: 1;">
                    <div class="details-bar">
                        <span>Unassigned Guests</span>
                        <span id="unassignedCount">(0)</span>
                    </div>
                    <div class="field-row">
                        <input type="text" id="searchGuests" placeholder="Search guests..." />
                    </div>
                    <div id="guestsContainer" style="min-height: 300px; overflow-y: auto;">
                        <div class="empty-state">
                            <p>Upload a CSV file to begin assigning guests to dormitory beds.</p>
                        </div>
                    </div>
                </div>

                <div class="standard-dialog" style="flex: 1;">
                    <div class="details-bar">
                        <span>Room Assignments</span>
                        <span id="assignedCount">(0)</span>
                    </div>
                    <div id="roomsContainer" style="min-height: 300px; overflow-y: auto;">
                        <div class="empty-state">
                            <p>Room layout will appear here once guest data is loaded.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Room Configuration Tab Content -->
        <div id="configurationContent" class="window-pane tab-content">
            <div class="details-bar">
                <div class="field-row">
                    <button class="btn" id="exportRoomsBtn">Export Room Config</button>
                    <button class="btn" id="importRoomsBtn">Import Room Config</button>
                    <input type="file" id="roomConfigFile" accept=".csv" style="display: none;" />
                </div>
            </div>

            <div class="main-container" style="display: flex; gap: 1rem;">
                <div class="standard-dialog" style="flex: 1;">
                    <div class="details-bar">
                        <span>Dormitories</span>
                        <button class="btn" id="addDormitoryBtn">+ Add</button>
                    </div>
                    <div id="dormitoriesContainer" style="min-height: 300px; overflow-y: auto;">
                        <div class="empty-state">
                            <p>No dormitories configured. Click "Add" to create your first dormitory.</p>
                        </div>
                    </div>
                </div>

                <div class="standard-dialog" style="flex: 1;">
                    <div class="details-bar">
                        <span id="selectedDormitoryName">Select a Dormitory</span>
                        <button class="btn" id="addRoomBtn" style="display: none;">+ Add Room</button>
                    </div>
                    <div id="roomConfigContainer" style="min-height: 300px; overflow-y: auto;">
                        <div class="empty-state">
                            <p>Select a dormitory to configure its rooms.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab Content -->
        <div id="settingsContent" class="window-pane tab-content">
            <div class="details-bar">
                <div class="field-row">
                    <button class="btn" id="resetSettingsBtn">Reset to Defaults</button>
                    <button class="btn" id="importSettingsBtn">Import Settings</button>
                    <button class="btn" id="exportSettingsBtn">Export Settings</button>
                    <input type="file" id="settingsFile" accept=".json" style="display: none;" />
                </div>
            </div>

            <div class="standard-dialog">
                <!-- Display Settings Section -->
                <h2>Display Settings</h2>
                <div class="field-row">
                    <input type="checkbox" id="showAgeHistograms" checked>
                    <label for="showAgeHistograms">Show age histograms on room cards</label>
                </div>

                <!-- Assignment Warnings Section -->
                <h2>Assignment Validation</h2>
                <div class="field-row">
                    <input type="checkbox" id="genderMismatchWarnings" checked>
                    <label for="genderMismatchWarnings">Gender mismatch warnings</label>
                </div>
                
                <div class="field-row">
                    <input type="checkbox" id="bunkPreferenceWarnings" checked>
                    <label for="bunkPreferenceWarnings">Bunk preference violations</label>
                </div>
                
                <div class="field-row">
                    <input type="checkbox" id="familySeparationWarnings" checked>
                    <label for="familySeparationWarnings">Family/group separation warnings</label>
                </div>
                
                <div class="field-row">
                    <input type="checkbox" id="roomAvailabilityWarnings" checked>
                    <label for="roomAvailabilityWarnings">Room availability warnings</label>
                </div>
            </div>
        </div>


    </div>

    <!-- Bed Configuration Modal -->
    <div id="bedConfigModal" class="modal-dialog" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;">
        <div class="modal-contents">
            <div class="title-bar">
                <button class="close hidden"></button>
                <h1 class="title" id="bedConfigTitle">Configure Beds</h1>
                <button class="close" onclick="app.closeBedConfiguration()">
                    <span>Close</span>
                </button>
            </div>
            
            <div class="details-bar">
                <h2 id="bedConfigRoomName">Room Name</h2>
                <span id="bedConfigRoomDetails">Room details will appear here</span>
            </div>

            <div class="field-row">
                <button class="btn" onclick="app.showAddBedInterface()">+ Add Bed</button>
                <button class="btn" onclick="app.closeBedConfiguration()">Close</button>
            </div>

            <div id="addBedInterface" style="display: none;">
                <h2>Add New Bed</h2>
                <div class="field-row bed-type-selector">
                    <div class="bed-type-option selected" data-type="single">
                        <span>Single</span>
                    </div>
                    <div class="bed-type-option" data-type="lower">
                        <span>Lower Bunk</span>
                    </div>
                    <div class="bed-type-option" data-type="upper">
                        <span>Upper Bunk</span>
                    </div>
                </div>
                <div class="field-row">
                    <button class="btn" onclick="app.addBedToCurrent()">Add Bed</button>
                    <button class="btn" onclick="app.hideAddBedInterface()">Cancel</button>
                </div>
            </div>

            <div>
                <h2>Beds in This Room</h2>
                <div id="bedConfigGrid" class="bed-grid">
                    <!-- Bed cards will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script src="js/app-utils.js"></script>
    <script src="js/app-storage.js"></script>
    <script src="js/app-validation.js"></script>
    <script src="app.js"></script>
    <script src="js/app-settings.js"></script>
</body>
</html>